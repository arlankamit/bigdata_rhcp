from typing import List, Optional

TEMPLATES = {
    "punctuality": "Маршрут {route} үшін таңертеңгі пикте интервалды қысқарту және қосымша рейстер енгізу ұсынылады.",
    "crowding":    "Маршрут {route} бойындағы толып кетуді азайту үшін үлкен сыйымдылықтағы көліктерді бөлу немесе қосымша рейстер ұйымдастыру қажет.",
    "safety":      "Қауіпсіздік бойынша дереу тексеру жүргізу және CCTV жазбаларын қарау ұсынылады.",
    "staff_behavior":"Қызметкерлерді клиентпен қарым-қатынас бойынша қайта оқыту және тәртіптік шаралар қолдану ұсынылады.",
    "vehicle_condition":"Көлікті техникалық тексерістен өткізу және санитарлық тазалау қажет.",
    "payment":     "Төлем жүйелерін тексеріп, валидаторлар мен POS терминалдардың жұмысын қалпына келтіру ұсынылады.",
    "temperature": "Жылыту/кондиционерді тексеру, температуралық режимді нормативке келтіру ұсынылады.",
    "other":       "Қосымша ақпарат алып, сәйкес шараларды анықтау ұсынылады."
}

TEMPLATES_NO_ROUTE = {
    "punctuality": "Таңертеңгі пикте интервалды қысқарту және қосымша рейстер енгізу ұсынылады.",
    "crowding":    "Толып кетуді азайту үшін үлкен сыйымдылықтағы көліктерді бөлу немесе қосымша рейстер ұйымдастыру қажет.",
    "safety":      "Қауіпсіздік бойынша дереу тексеру жүргізу және CCTV жазбаларын қарау ұсынылады.",
    "staff_behavior":"Қызметкерлерді клиентпен қарым-қатынас бойынша қайта оқыту және тәртіптік шаралар қолдану ұсынылады.",
    "vehicle_condition":"Көлікті техникалық тексерістен өткізу және санитарлық тазалау қажет.",
    "payment":     "Төлем жүйелерін тексеріп, валидаторлар мен POS терминалдардың жұмысын қалпына келтіру ұсынылады.",
    "temperature": "Жылыту/кондиционерді тексеру, температуралық режимді нормативке келтіру ұсынылады.",
    "other":       "Қосымша ақпарат алып, сәйкес шараларды анықтау ұсынылады."
}

def generate_advice(aspects: List[str], route: Optional[str]) -> str:
    asp = aspects[0] if aspects else "other"
    if route:
        return TEMPLATES.get(asp, TEMPLATES["other"]).format(route=route)
    return TEMPLATES_NO_ROUTE.get(asp, TEMPLATES_NO_ROUTE["other"])
